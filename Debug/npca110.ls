   1                     ; C Compiler for STM8 (COSMIC Software)
   2                     ; Generator V4.2.4 - 19 Dec 2007
2534                     	bsct
2535  0000               _npca110_aux:
2536  0000 00            	dc.b	0
2537  0001               L3361_npca110_exti:
2538  0001 01            	dc.b	1
2539  0002               L5361_npca110_busy:
2540  0002 00            	dc.b	0
2541                     .const:	section	.text
2542  0000               L7361_cfg_tab:
2543  0000 00            	dc.b	0
2544  0001 a5            	dc.b	165
2545  0002 00            	dc.b	0
2546  0003 00            	dc.b	0
2547  0004 a5            	dc.b	165
2548  0005 00            	dc.b	0
2549  0006 00            	dc.b	0
2550  0007 a5            	dc.b	165
2551  0008 00            	dc.b	0
2552  0009 00            	dc.b	0
2553  000a b8            	dc.b	184
2554  000b 00            	dc.b	0
2555  000c 00            	dc.b	0
2556  000d b7            	dc.b	183
2557  000e 00            	dc.b	0
2558  000f ff            	dc.b	255
2559  0010 b5            	dc.b	181
2560  0011 f1            	dc.b	241
2561  0012 00            	dc.b	0
2562  0013 c5            	dc.b	197
2563  0014 00            	dc.b	0
2564  0015 00            	dc.b	0
2565  0016 a5            	dc.b	165
2566  0017 00            	dc.b	0
2567  0018 ff            	dc.b	255
2568  0019 ab            	dc.b	171
2569  001a f3            	dc.b	243
2570  001b 00            	dc.b	0
2571  001c 00            	dc.b	0
2572  001d d0            	dc.b	208
2573  001e               L1461_ain1_tab:
2574  001e 00            	dc.b	0
2575  001f a4            	dc.b	164
2576  0020 11            	dc.b	17
2577  0021 00            	dc.b	0
2578  0022 00            	dc.b	0
2579  0023 00            	dc.b	0
2580  0024 00            	dc.b	0
2581  0025 00            	dc.b	0
2582  0026 00            	dc.b	0
2583  0027 00            	dc.b	0
2584  0028 00            	dc.b	0
2585  0029 00            	dc.b	0
2586  002a 08            	dc.b	8
2587  002b 88            	dc.b	136
2588  002c fd            	dc.b	253
2589  002d 00            	dc.b	0
2590  002e 00            	dc.b	0
2591  002f 00            	dc.b	0
2592  0030 00            	dc.b	0
2593  0031 00            	dc.b	0
2594  0032 00            	dc.b	0
2595  0033 00            	dc.b	0
2596  0034 00            	dc.b	0
2597  0035 00            	dc.b	0
2598  0036 00            	dc.b	0
2599  0037 00            	dc.b	0
2600  0038 00            	dc.b	0
2601  0039 00            	dc.b	0
2602  003a 00            	dc.b	0
2603  003b 00            	dc.b	0
2604  003c 00            	dc.b	0
2605  003d 00            	dc.b	0
2606  003e 00            	dc.b	0
2607  003f 7f            	dc.b	127
2608  0040 ff            	dc.b	255
2609  0041 ff            	dc.b	255
2610  0042 00            	dc.b	0
2611  0043 00            	dc.b	0
2612  0044 00            	dc.b	0
2613  0045 00            	dc.b	0
2614  0046 00            	dc.b	0
2615  0047 00            	dc.b	0
2616  0048 00            	dc.b	0
2617  0049 00            	dc.b	0
2618  004a 00            	dc.b	0
2619  004b 00            	dc.b	0
2620  004c 00            	dc.b	0
2621  004d 00            	dc.b	0
2622  004e 00            	dc.b	0
2623  004f 00            	dc.b	0
2624  0050 00            	dc.b	0
2625  0051 3a            	dc.b	58
2626  0052 81            	dc.b	129
2627  0053 dd            	dc.b	221
2628  0054 00            	dc.b	0
2629  0055 c8            	dc.b	200
2630  0056 00            	dc.b	0
2631  0057 ff            	dc.b	255
2632  0058 ad            	dc.b	173
2633  0059 83            	dc.b	131
2634  005a 00            	dc.b	0
2635  005b 00            	dc.b	0
2636  005c 88            	dc.b	136
2637  005d ff            	dc.b	255
2638  005e ad            	dc.b	173
2639  005f 86            	dc.b	134
2640  0060 00            	dc.b	0
2641  0061 00            	dc.b	0
2642  0062 00            	dc.b	0
2643  0063 ff            	dc.b	255
2644  0064 ad            	dc.b	173
2645  0065 86            	dc.b	134
2646  0066 00            	dc.b	0
2647  0067 00            	dc.b	0
2648  0068 01            	dc.b	1
2649  0069 ff            	dc.b	255
2650  006a ad            	dc.b	173
2651  006b 86            	dc.b	134
2652  006c 00            	dc.b	0
2653  006d 00            	dc.b	0
2654  006e 00            	dc.b	0
2655  006f               L3461_dig_tab:
2656  006f 00            	dc.b	0
2657  0070 a4            	dc.b	164
2658  0071 11            	dc.b	17
2659  0072 0b            	dc.b	11
2660  0073 0f            	dc.b	15
2661  0074 10            	dc.b	16
2662  0075 00            	dc.b	0
2663  0076 00            	dc.b	0
2664  0077 00            	dc.b	0
2665  0078 00            	dc.b	0
2666  0079 00            	dc.b	0
2667  007a 00            	dc.b	0
2668  007b 00            	dc.b	0
2669  007c 00            	dc.b	0
2670  007d 00            	dc.b	0
2671  007e 00            	dc.b	0
2672  007f 00            	dc.b	0
2673  0080 00            	dc.b	0
2674  0081 00            	dc.b	0
2675  0082 00            	dc.b	0
2676  0083 00            	dc.b	0
2677  0084 00            	dc.b	0
2678  0085 00            	dc.b	0
2679  0086 00            	dc.b	0
2680  0087 00            	dc.b	0
2681  0088 00            	dc.b	0
2682  0089 00            	dc.b	0
2683  008a 00            	dc.b	0
2684  008b 00            	dc.b	0
2685  008c 00            	dc.b	0
2686  008d 00            	dc.b	0
2687  008e 00            	dc.b	0
2688  008f 00            	dc.b	0
2689  0090 7f            	dc.b	127
2690  0091 ff            	dc.b	255
2691  0092 ff            	dc.b	255
2692  0093 00            	dc.b	0
2693  0094 00            	dc.b	0
2694  0095 00            	dc.b	0
2695  0096 00            	dc.b	0
2696  0097 00            	dc.b	0
2697  0098 00            	dc.b	0
2698  0099 00            	dc.b	0
2699  009a 00            	dc.b	0
2700  009b 00            	dc.b	0
2701  009c 00            	dc.b	0
2702  009d 00            	dc.b	0
2703  009e 00            	dc.b	0
2704  009f 00            	dc.b	0
2705  00a0 00            	dc.b	0
2706  00a1 00            	dc.b	0
2707  00a2 3a            	dc.b	58
2708  00a3 81            	dc.b	129
2709  00a4 dd            	dc.b	221
2710  00a5 00            	dc.b	0
2711  00a6 c8            	dc.b	200
2712  00a7 00            	dc.b	0
2713  00a8               L5461_volume_tab:
2714  00a8 00c8          	dc.w	200
2715  00aa 00fa          	dc.w	250
2716  00ac 012c          	dc.w	300
2717  00ae 0145          	dc.w	325
2718  00b0 015e          	dc.w	350
2719  00b2 0177          	dc.w	375
2720  00b4 0190          	dc.w	400
2721  00b6 019a          	dc.w	410
2722  00b8 01a4          	dc.w	420
2723  00ba 01ae          	dc.w	430
2724  00bc 01b8          	dc.w	440
2725  00be 01bd          	dc.w	445
2726  00c0 01c2          	dc.w	450
2766                     ; 85 static void NPCA110_Wait(u32 t)
2766                     ; 86 {
2768                     	switch	.text
2769  0000               L7461_NPCA110_Wait:
2771       00000000      OFST:	set	0
2774  0000               L1071:
2775                     ; 87 	while(t--);
2777  0000 96            	ldw	x,sp
2778  0001 1c0003        	addw	x,#OFST+3
2779  0004 cd0000        	call	c_ltor
2781  0007 96            	ldw	x,sp
2782  0008 1c0003        	addw	x,#OFST+3
2783  000b a601          	ld	a,#1
2784  000d cd0000        	call	c_lgsbc
2786  0010 cd0000        	call	c_lrzmp
2788  0013 26eb          	jrne	L1071
2789                     ; 88 }
2792  0015 81            	ret
2847                     ; 90 void NPCA110_WriteNByte(u8 *p,u8 n)
2847                     ; 91 {
2848                     	switch	.text
2849  0016               L1561_NPCA110_WriteNByte:
2851  0016 89            	pushw	x
2852  0017 88            	push	a
2853       00000001      OFST:	set	1
2856                     ; 92 	u8 i=0;
2858  0018 0f01          	clr	(OFST+0,sp)
2859                     ; 94 	for(i=0;i<n;i++)
2861  001a 0f01          	clr	(OFST+0,sp)
2863  001c 2014          	jra	L7371
2864  001e               L3371:
2865                     ; 96 		I2C_WriteByte(*(p+i));
2867  001e 7b02          	ld	a,(OFST+1,sp)
2868  0020 97            	ld	xl,a
2869  0021 7b03          	ld	a,(OFST+2,sp)
2870  0023 1b01          	add	a,(OFST+0,sp)
2871  0025 2401          	jrnc	L01
2872  0027 5c            	incw	x
2873  0028               L01:
2874  0028 02            	rlwa	x,a
2875  0029 f6            	ld	a,(x)
2876  002a cd0000        	call	_I2C_WriteByte
2878                     ; 97 		I2C_ReadAck();
2880  002d cd0000        	call	_I2C_ReadAck
2882                     ; 94 	for(i=0;i<n;i++)
2884  0030 0c01          	inc	(OFST+0,sp)
2885  0032               L7371:
2888  0032 7b01          	ld	a,(OFST+0,sp)
2889  0034 1106          	cp	a,(OFST+5,sp)
2890  0036 25e6          	jrult	L3371
2891                     ; 99 }
2894  0038 5b03          	addw	sp,#3
2895  003a 81            	ret
2928                     ; 101 void NPCA110_Init(void)
2928                     ; 102 {
2929                     	switch	.text
2930  003b               _NPCA110_Init:
2934                     ; 103 	PA_DDR|=1<<3;
2936  003b 72165002      	bset	_PA_DDR,#3
2937                     ; 104 	PA_CR1|=1<<3;
2939  003f 72165003      	bset	_PA_CR1,#3
2940                     ; 105 	PA_CR2&=~(1<<3);
2942  0043 72175004      	bres	_PA_CR2,#3
2943                     ; 106 	NPCA110_RST_0();
2945  0047 72175000      	bres	_PA_ODR,#3
2946                     ; 107 	NPCA110_Wait(10);
2948  004b ae000a        	ldw	x,#10
2949  004e 89            	pushw	x
2950  004f ae0000        	ldw	x,#0
2951  0052 89            	pushw	x
2952  0053 adab          	call	L7461_NPCA110_Wait
2954  0055 5b04          	addw	sp,#4
2955                     ; 108 	NPCA110_RST_1();
2957  0057 72165000      	bset	_PA_ODR,#3
2958                     ; 109 	NPCA110_Wait(10);
2960  005b ae000a        	ldw	x,#10
2961  005e 89            	pushw	x
2962  005f ae0000        	ldw	x,#0
2963  0062 89            	pushw	x
2964  0063 ad9b          	call	L7461_NPCA110_Wait
2966  0065 5b04          	addw	sp,#4
2967                     ; 111 	_asm("sim");
2970  0067 9b            sim
2972                     ; 112 	PC_DDR&=~(1<<3);//上拉中断
2974  0068 7217500c      	bres	_PC_DDR,#3
2975                     ; 113 	PC_CR1|=(1<<3);
2977  006c 7216500d      	bset	_PC_CR1,#3
2978                     ; 114 	PC_CR2|=(1<<3);
2980  0070 7216500e      	bset	_PC_CR2,#3
2981                     ; 115 	EXTI_CR1|=(1<<4);//下降沿触发
2983  0074 721850a0      	bset	_EXTI_CR1,#4
2984                     ; 116 	EXTI_CR1|=(1<<5);//上升沿触发
2986  0078 721a50a0      	bset	_EXTI_CR1,#5
2987                     ; 117 	_asm("rim");
2990  007c 9a            rim
2992                     ; 119 	I2C_Init();
2994  007d cd0000        	call	_I2C_Init
2996                     ; 120 }
2999  0080 81            	ret
3041                     ; 122 void NPCA110_WriteCofig(void)
3041                     ; 123 {
3042                     	switch	.text
3043  0081               _NPCA110_WriteCofig:
3045  0081 89            	pushw	x
3046       00000002      OFST:	set	2
3049                     ; 124 	u16 i=0;
3051  0082 5f            	clrw	x
3052  0083 1f01          	ldw	(OFST-1,sp),x
3053                     ; 126 	for(i=0;i<7;i++)
3055  0085 5f            	clrw	x
3056  0086 1f01          	ldw	(OFST-1,sp),x
3057  0088               L1771:
3058                     ; 128 		I2C_Start();
3060  0088 cd0000        	call	_I2C_Start
3062                     ; 129 		I2C_WriteByte(0xe6);
3064  008b a6e6          	ld	a,#230
3065  008d cd0000        	call	_I2C_WriteByte
3067                     ; 130 		I2C_ReadAck();
3069  0090 cd0000        	call	_I2C_ReadAck
3071                     ; 131 		NPCA110_WriteNByte(&cfg_tab[3*i],3);
3073  0093 4b03          	push	#3
3074  0095 1e02          	ldw	x,(OFST+0,sp)
3075  0097 90ae0003      	ldw	y,#3
3076  009b cd0000        	call	c_imul
3078  009e 1c0000        	addw	x,#L7361_cfg_tab
3079  00a1 cd0016        	call	L1561_NPCA110_WriteNByte
3081  00a4 84            	pop	a
3082                     ; 132 		I2C_Stop();
3084  00a5 cd0000        	call	_I2C_Stop
3086                     ; 126 	for(i=0;i<7;i++)
3088  00a8 1e01          	ldw	x,(OFST-1,sp)
3089  00aa 1c0001        	addw	x,#1
3090  00ad 1f01          	ldw	(OFST-1,sp),x
3093  00af 1e01          	ldw	x,(OFST-1,sp)
3094  00b1 a30007        	cpw	x,#7
3095  00b4 25d2          	jrult	L1771
3096                     ; 134 	NPCA110_Wait(5000);
3098  00b6 ae1388        	ldw	x,#5000
3099  00b9 89            	pushw	x
3100  00ba ae0000        	ldw	x,#0
3101  00bd 89            	pushw	x
3102  00be cd0000        	call	L7461_NPCA110_Wait
3104  00c1 5b04          	addw	sp,#4
3105                     ; 135 	for(i=7;i<10;i++)
3107  00c3 ae0007        	ldw	x,#7
3108  00c6 1f01          	ldw	(OFST-1,sp),x
3109  00c8               L7771:
3110                     ; 137 		I2C_Start();
3112  00c8 cd0000        	call	_I2C_Start
3114                     ; 138 		I2C_WriteByte(0xe6);
3116  00cb a6e6          	ld	a,#230
3117  00cd cd0000        	call	_I2C_WriteByte
3119                     ; 139 		I2C_ReadAck();
3121  00d0 cd0000        	call	_I2C_ReadAck
3123                     ; 140 		NPCA110_WriteNByte(&cfg_tab[3*i],3);
3125  00d3 4b03          	push	#3
3126  00d5 1e02          	ldw	x,(OFST+0,sp)
3127  00d7 90ae0003      	ldw	y,#3
3128  00db cd0000        	call	c_imul
3130  00de 1c0000        	addw	x,#L7361_cfg_tab
3131  00e1 cd0016        	call	L1561_NPCA110_WriteNByte
3133  00e4 84            	pop	a
3134                     ; 141 		I2C_Stop();
3136  00e5 cd0000        	call	_I2C_Stop
3138                     ; 135 	for(i=7;i<10;i++)
3140  00e8 1e01          	ldw	x,(OFST-1,sp)
3141  00ea 1c0001        	addw	x,#1
3142  00ed 1f01          	ldw	(OFST-1,sp),x
3145  00ef 1e01          	ldw	x,(OFST-1,sp)
3146  00f1 a3000a        	cpw	x,#10
3147  00f4 25d2          	jrult	L7771
3148                     ; 143 	for(i=2;i<703;i++)
3150  00f6 ae0002        	ldw	x,#2
3151  00f9 1f01          	ldw	(OFST-1,sp),x
3152  00fb               L5002:
3153                     ; 145 		I2C_Start();
3155  00fb cd0000        	call	_I2C_Start
3157                     ; 146 		I2C_WriteByte(0xe6);
3159  00fe a6e6          	ld	a,#230
3160  0100 cd0000        	call	_I2C_WriteByte
3162                     ; 147 		I2C_ReadAck();
3164  0103 cd0000        	call	_I2C_ReadAck
3166                     ; 148 		NPCA110_WriteNByte(&g_abMaxxDSPCommands[3*i],3);
3168  0106 4b03          	push	#3
3169  0108 1e02          	ldw	x,(OFST+0,sp)
3170  010a 90ae0003      	ldw	y,#3
3171  010e cd0000        	call	c_imul
3173  0111 1c0000        	addw	x,#_g_abMaxxDSPCommands
3174  0114 cd0016        	call	L1561_NPCA110_WriteNByte
3176  0117 84            	pop	a
3177                     ; 149 		I2C_Stop();
3179  0118 cd0000        	call	_I2C_Stop
3181                     ; 143 	for(i=2;i<703;i++)
3183  011b 1e01          	ldw	x,(OFST-1,sp)
3184  011d 1c0001        	addw	x,#1
3185  0120 1f01          	ldw	(OFST-1,sp),x
3188  0122 1e01          	ldw	x,(OFST-1,sp)
3189  0124 a302bf        	cpw	x,#703
3190  0127 25d2          	jrult	L5002
3191                     ; 151 }
3194  0129 85            	popw	x
3195  012a 81            	ret
3198                     	bsct
3199  0003               L3102_count:
3200  0003 00000000      	dc.l	0
3201  0007               L5102_mode:
3202  0007 00            	dc.b	0
3203  0008               L7102_out:
3204  0008 00            	dc.b	0
3205  0009               L1202_in:
3206  0009 00            	dc.b	0
3270                     	switch	.const
3271  00c2               L02:
3272  00c2 00000065      	dc.l	101
3273                     ; 153 void NPCA110_AuxScan_Ser(void)
3273                     ; 154 {
3274                     	switch	.text
3275  012b               _NPCA110_AuxScan_Ser:
3279                     ; 160 	if(npca110_busy)
3281  012b 3d02          	tnz	L5361_npca110_busy
3282  012d 274f          	jreq	L5502
3283                     ; 162 		count++;
3285  012f ae0003        	ldw	x,#L3102_count
3286  0132 a601          	ld	a,#1
3287  0134 cd0000        	call	c_lgadc
3289                     ; 163 		if(count>100)
3291  0137 ae0003        	ldw	x,#L3102_count
3292  013a cd0000        	call	c_ltor
3294  013d ae00c2        	ldw	x,#L02
3295  0140 cd0000        	call	c_lcmp
3297  0143 2545          	jrult	L3702
3298                     ; 165 			count=0;
3300  0145 ae0000        	ldw	x,#0
3301  0148 bf05          	ldw	L3102_count+2,x
3302  014a ae0000        	ldw	x,#0
3303  014d bf03          	ldw	L3102_count,x
3304                     ; 166 			mode++;
3306  014f 3c07          	inc	L5102_mode
3307                     ; 167 			if(mode>100)
3309  0151 b607          	ld	a,L5102_mode
3310  0153 a165          	cp	a,#101
3311  0155 2518          	jrult	L1602
3312                     ; 169 				mode=0;
3314  0157 3f07          	clr	L5102_mode
3315                     ; 170 				npca110_busy=0;
3317  0159 3f02          	clr	L5361_npca110_busy
3318                     ; 171 				if(out>in)
3320  015b b608          	ld	a,L7102_out
3321  015d b109          	cp	a,L1202_in
3322  015f 2306          	jrule	L3602
3323                     ; 173 					npca110_aux=AUX_PULL;
3325  0161 35020000      	mov	_npca110_aux,#2
3327  0165 2004          	jra	L5602
3328  0167               L3602:
3329                     ; 177 					npca110_aux=AUX_INSERT;
3331  0167 35010000      	mov	_npca110_aux,#1
3332  016b               L5602:
3333                     ; 179 				out=0;
3335  016b 3f08          	clr	L7102_out
3336                     ; 180 				in=0;
3338  016d 3f09          	clr	L1202_in
3339  016f               L1602:
3340                     ; 182 			if(NPCA110_AUX)
3342  016f c6500b        	ld	a,_PC_IDR
3343  0172 a508          	bcp	a,#8
3344  0174 2704          	jreq	L7602
3345                     ; 184 				out++;
3347  0176 3c08          	inc	L7102_out
3349  0178 2010          	jra	L3702
3350  017a               L7602:
3351                     ; 188 				in++;
3353  017a 3c09          	inc	L1202_in
3354  017c 200c          	jra	L3702
3355  017e               L5502:
3356                     ; 194 		if(npca110_exti)
3358  017e 3d01          	tnz	L3361_npca110_exti
3359  0180 2708          	jreq	L3702
3360                     ; 196 			npca110_exti=0;
3362  0182 3f01          	clr	L3361_npca110_exti
3363                     ; 197 			npca110_busy=1;
3365  0184 35010002      	mov	L5361_npca110_busy,#1
3366                     ; 198 			npca110_aux=AUX_SHAKE;
3368  0188 3f00          	clr	_npca110_aux
3369  018a               L3702:
3370                     ; 201 }
3373  018a 81            	ret
3399                     ; 203 void NPCA110_AuxScan_ISR(void)
3399                     ; 204 {
3400                     	switch	.text
3401  018b               _NPCA110_AuxScan_ISR:
3405                     ; 205 	if(npca110_busy==0)
3407  018b 3d02          	tnz	L5361_npca110_busy
3408  018d 2604          	jrne	L7012
3409                     ; 207 		npca110_exti=1;
3411  018f 35010001      	mov	L3361_npca110_exti,#1
3412  0193               L7012:
3413                     ; 209 }
3416  0193 81            	ret
3456                     ; 211 void NPCA110_WriteAn1(void)
3456                     ; 212 {
3457                     	switch	.text
3458  0194               _NPCA110_WriteAn1:
3460  0194 88            	push	a
3461       00000001      OFST:	set	1
3464                     ; 213 	u8	i=0;
3466  0195 0f01          	clr	(OFST+0,sp)
3467                     ; 215 	for(i=0;i<27;i++)
3469  0197 0f01          	clr	(OFST+0,sp)
3470  0199               L7212:
3471                     ; 217 		I2C_Start();
3473  0199 cd0000        	call	_I2C_Start
3475                     ; 218 		I2C_WriteByte(0xe6);
3477  019c a6e6          	ld	a,#230
3478  019e cd0000        	call	_I2C_WriteByte
3480                     ; 219 		I2C_ReadAck();
3482  01a1 cd0000        	call	_I2C_ReadAck
3484                     ; 220 		NPCA110_WriteNByte(&ain1_tab[3*i],3);
3486  01a4 4b03          	push	#3
3487  01a6 7b02          	ld	a,(OFST+1,sp)
3488  01a8 97            	ld	xl,a
3489  01a9 a603          	ld	a,#3
3490  01ab 42            	mul	x,a
3491  01ac 1c001e        	addw	x,#L1461_ain1_tab
3492  01af cd0016        	call	L1561_NPCA110_WriteNByte
3494  01b2 84            	pop	a
3495                     ; 221 		I2C_Stop();
3497  01b3 cd0000        	call	_I2C_Stop
3499                     ; 215 	for(i=0;i<27;i++)
3501  01b6 0c01          	inc	(OFST+0,sp)
3504  01b8 7b01          	ld	a,(OFST+0,sp)
3505  01ba a11b          	cp	a,#27
3506  01bc 25db          	jrult	L7212
3507                     ; 223 }
3510  01be 84            	pop	a
3511  01bf 81            	ret
3551                     ; 225 void NPCA110_WriteDig(void)
3551                     ; 226 {
3552                     	switch	.text
3553  01c0               _NPCA110_WriteDig:
3555  01c0 88            	push	a
3556       00000001      OFST:	set	1
3559                     ; 227 	u8	i=0;
3561  01c1 0f01          	clr	(OFST+0,sp)
3562                     ; 229 	for(i=0;i<19;i++)
3564  01c3 0f01          	clr	(OFST+0,sp)
3565  01c5               L3512:
3566                     ; 231 		I2C_Start();
3568  01c5 cd0000        	call	_I2C_Start
3570                     ; 232 		I2C_WriteByte(0xe6);
3572  01c8 a6e6          	ld	a,#230
3573  01ca cd0000        	call	_I2C_WriteByte
3575                     ; 233 		I2C_ReadAck();
3577  01cd cd0000        	call	_I2C_ReadAck
3579                     ; 234 		NPCA110_WriteNByte(&dig_tab[3*i],3);
3581  01d0 4b03          	push	#3
3582  01d2 7b02          	ld	a,(OFST+1,sp)
3583  01d4 97            	ld	xl,a
3584  01d5 a603          	ld	a,#3
3585  01d7 42            	mul	x,a
3586  01d8 1c006f        	addw	x,#L3461_dig_tab
3587  01db cd0016        	call	L1561_NPCA110_WriteNByte
3589  01de 84            	pop	a
3590                     ; 235 		I2C_Stop();
3592  01df cd0000        	call	_I2C_Stop
3594                     ; 229 	for(i=0;i<19;i++)
3596  01e2 0c01          	inc	(OFST+0,sp)
3599  01e4 7b01          	ld	a,(OFST+0,sp)
3600  01e6 a113          	cp	a,#19
3601  01e8 25db          	jrult	L3512
3602                     ; 237 }
3605  01ea 84            	pop	a
3606  01eb 81            	ret
3673                     ; 239 void NPCA110_WriteVolume(u8 volume)
3673                     ; 240 {
3674                     	switch	.text
3675  01ec               _NPCA110_WriteVolume:
3677  01ec 88            	push	a
3678  01ed 5204          	subw	sp,#4
3679       00000004      OFST:	set	4
3682                     ; 241 	u16 word=0;
3684  01ef 1e03          	ldw	x,(OFST-1,sp)
3685                     ; 242 	u8 byte_high=0;
3687  01f1 7b01          	ld	a,(OFST-3,sp)
3688  01f3 97            	ld	xl,a
3689                     ; 243 	u8 byte_low=0;
3691  01f4 7b02          	ld	a,(OFST-2,sp)
3692  01f6 97            	ld	xl,a
3693                     ; 245 	word=volume_tab[volume];//-40db=200/5(2db一个等级)
3695  01f7 7b05          	ld	a,(OFST+1,sp)
3696  01f9 5f            	clrw	x
3697  01fa 97            	ld	xl,a
3698  01fb 58            	sllw	x
3699  01fc de00a8        	ldw	x,(L5461_volume_tab,x)
3700  01ff 1f03          	ldw	(OFST-1,sp),x
3701                     ; 246 	byte_high=word>>8;
3703  0201 7b03          	ld	a,(OFST-1,sp)
3704  0203 6b01          	ld	(OFST-3,sp),a
3705                     ; 247 	byte_low=word&0xff;
3707  0205 7b04          	ld	a,(OFST+0,sp)
3708  0207 a4ff          	and	a,#255
3709  0209 6b02          	ld	(OFST-2,sp),a
3710                     ; 248 	I2C_Start();
3712  020b cd0000        	call	_I2C_Start
3714                     ; 249 	I2C_WriteByte(0xe6);
3716  020e a6e6          	ld	a,#230
3717  0210 cd0000        	call	_I2C_WriteByte
3719                     ; 250 	I2C_ReadAck();
3721  0213 cd0000        	call	_I2C_ReadAck
3723                     ; 251 	I2C_WriteByte(byte_high);
3725  0216 7b01          	ld	a,(OFST-3,sp)
3726  0218 cd0000        	call	_I2C_WriteByte
3728                     ; 252 	I2C_ReadAck();
3730  021b cd0000        	call	_I2C_ReadAck
3732                     ; 253 	I2C_WriteByte(0xd0);
3734  021e a6d0          	ld	a,#208
3735  0220 cd0000        	call	_I2C_WriteByte
3737                     ; 254 	I2C_ReadAck();
3739  0223 cd0000        	call	_I2C_ReadAck
3741                     ; 255 	I2C_WriteByte(byte_low);
3743  0226 7b02          	ld	a,(OFST-2,sp)
3744  0228 cd0000        	call	_I2C_WriteByte
3746                     ; 256 	I2C_ReadAck();
3748  022b cd0000        	call	_I2C_ReadAck
3750                     ; 257 	I2C_Stop();
3752  022e cd0000        	call	_I2C_Stop
3754                     ; 258 }
3757  0231 5b05          	addw	sp,#5
3758  0233 81            	ret
3785                     ; 260 void NPCA110_WriteMute(void)
3785                     ; 261 {
3786                     	switch	.text
3787  0234               _NPCA110_WriteMute:
3791                     ; 262 	I2C_Start();
3793  0234 cd0000        	call	_I2C_Start
3795                     ; 263 	I2C_WriteByte(0xe6);
3797  0237 a6e6          	ld	a,#230
3798  0239 cd0000        	call	_I2C_WriteByte
3800                     ; 264 	I2C_ReadAck();
3802  023c cd0000        	call	_I2C_ReadAck
3804                     ; 265 	I2C_WriteByte(0x00);
3806  023f 4f            	clr	a
3807  0240 cd0000        	call	_I2C_WriteByte
3809                     ; 266 	I2C_ReadAck();
3811  0243 cd0000        	call	_I2C_ReadAck
3813                     ; 267 	I2C_WriteByte(0xc7);
3815  0246 a6c7          	ld	a,#199
3816  0248 cd0000        	call	_I2C_WriteByte
3818                     ; 268 	I2C_ReadAck();
3820  024b cd0000        	call	_I2C_ReadAck
3822                     ; 269 	I2C_WriteByte(0x01);
3824  024e a601          	ld	a,#1
3825  0250 cd0000        	call	_I2C_WriteByte
3827                     ; 270 	I2C_ReadAck();
3829  0253 cd0000        	call	_I2C_ReadAck
3831                     ; 271 	I2C_Stop();
3833  0256 cd0000        	call	_I2C_Stop
3835                     ; 272 }
3838  0259 81            	ret
3865                     ; 274 void NPCA110_WriteNMute(void)
3865                     ; 275 {
3866                     	switch	.text
3867  025a               _NPCA110_WriteNMute:
3871                     ; 276 	I2C_Start();
3873  025a cd0000        	call	_I2C_Start
3875                     ; 277 	I2C_WriteByte(0xe6);
3877  025d a6e6          	ld	a,#230
3878  025f cd0000        	call	_I2C_WriteByte
3880                     ; 278 	I2C_ReadAck();
3882  0262 cd0000        	call	_I2C_ReadAck
3884                     ; 279 	I2C_WriteByte(0x00);
3886  0265 4f            	clr	a
3887  0266 cd0000        	call	_I2C_WriteByte
3889                     ; 280 	I2C_ReadAck();
3891  0269 cd0000        	call	_I2C_ReadAck
3893                     ; 281 	I2C_WriteByte(0xc7);
3895  026c a6c7          	ld	a,#199
3896  026e cd0000        	call	_I2C_WriteByte
3898                     ; 282 	I2C_ReadAck();
3900  0271 cd0000        	call	_I2C_ReadAck
3902                     ; 283 	I2C_WriteByte(0x00);
3904  0274 4f            	clr	a
3905  0275 cd0000        	call	_I2C_WriteByte
3907                     ; 284 	I2C_ReadAck();
3909  0278 cd0000        	call	_I2C_ReadAck
3911                     ; 285 	I2C_Stop();
3913  027b cd0000        	call	_I2C_Stop
3915                     ; 286 }
3918  027e 81            	ret
4000                     	xref	_g_abMaxxDSPCommands
4001                     	xref	_I2C_WriteByte
4002                     	xref	_I2C_ReadAck
4003                     	xref	_I2C_Stop
4004                     	xref	_I2C_Start
4005                     	xref	_I2C_Init
4006                     	xdef	_NPCA110_WriteNMute
4007                     	xdef	_NPCA110_WriteMute
4008                     	xdef	_NPCA110_WriteVolume
4009                     	xdef	_NPCA110_WriteDig
4010                     	xdef	_NPCA110_WriteAn1
4011                     	xdef	_NPCA110_AuxScan_ISR
4012                     	xdef	_NPCA110_AuxScan_Ser
4013                     	xdef	_NPCA110_WriteCofig
4014                     	xdef	_NPCA110_Init
4015                     	xdef	_npca110_aux
4034                     	xref	c_lcmp
4035                     	xref	c_lgadc
4036                     	xref	c_imul
4037                     	xref	c_lrzmp
4038                     	xref	c_lgsbc
4039                     	xref	c_ltor
4040                     	end
